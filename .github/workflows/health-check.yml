name: Resources health-check

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 15 * *' # At 12:00 AM, on day 15 of the month

jobs:
  Health-check:
    runs-on: ubuntu-latest
    timeout-minutes: 45 # higher timeout because network requests can be slow in CI
    steps:
      - uses: actions/checkout@v2
      - name: Path resources healthcheck
        uses: cypress-io/github-action@v4
        env:
          CYPRESS_baseUrl: https://www.sherpa.guide
          CYPRESS_retries: 0
          CYPRESS_pageLoadTimeout: 60000
          CYPRESS_requestTimeout: 30000
          CYPRESS_ZENSCRAPE_API_KEY: ${{ secrets.ZENSCRAPE_API_KEY }}
        with:
          browser: chrome
          spec: cypress/e2e/paths/resources.cy.ts # Running only resources tests
